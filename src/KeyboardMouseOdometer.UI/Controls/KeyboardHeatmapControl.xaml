<UserControl x:Class="KeyboardMouseOdometer.UI.Controls.KeyboardHeatmapControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="400" d:DesignWidth="900">
    
    <UserControl.Resources>
        <!-- Key button style -->
        <Style x:Key="KeyButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#FF2D2D30"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#FF3F3F46"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Border x:Name="Border" 
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4">
                                <Grid>
                                    <!-- Heat overlay -->
                                    <Rectangle x:Name="HeatOverlay" 
                                               RadiusX="3" RadiusY="3"
                                               Opacity="0.7"/>
                                    
                                    <!-- Key label -->
                                    <ContentPresenter HorizontalAlignment="Center" 
                                                      VerticalAlignment="Center"
                                                      TextBlock.Foreground="{TemplateBinding Foreground}"/>
                                </Grid>
                            </Border>
                            
                            <!-- Tooltip -->
                            <Grid.ToolTip>
                                <ToolTip Placement="Top">
                                    <StackPanel>
                                        <TextBlock FontWeight="Bold" Text="{Binding DisplayText}"/>
                                        <TextBlock>
                                            <TextBlock.Text>
                                                <MultiBinding StringFormat="Pressed: {0:N0} times">
                                                    <Binding Path="PressCount"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                    </StackPanel>
                                </ToolTip>
                            </Grid.ToolTip>
                        </Grid>
                        
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="#FF007ACC"/>
                                <Setter TargetName="Border" Property="BorderThickness" Value="2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>
    
    <Grid Background="#FF1E1E1E">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Header with statistics -->
        <Border Grid.Row="0" Background="#FF252526" Padding="10" Margin="0,0,0,5">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <TextBlock Text="Total Keys: " Foreground="#FFB4B4B4" VerticalAlignment="Center"/>
                <TextBlock Text="{Binding TotalKeyPresses, StringFormat=N0}" 
                           Foreground="White" FontWeight="Bold" Margin="0,0,20,0" VerticalAlignment="Center"/>
                
                <TextBlock Text="Most Used: " Foreground="#FFB4B4B4" VerticalAlignment="Center"/>
                <TextBlock Text="{Binding MostUsedKey}" 
                           Foreground="#FF4EC9B0" FontWeight="Bold" Margin="0,0,5,0" VerticalAlignment="Center"/>
                <TextBlock Text="{Binding MostUsedKeyCount, StringFormat='({0:N0})'}" 
                           Foreground="#FFB4B4B4" Margin="0,0,20,0" VerticalAlignment="Center"/>
                
                <TextBlock Text="Typing Speed: " Foreground="#FFB4B4B4" VerticalAlignment="Center"/>
                <TextBlock Text="{Binding TypingSpeed, StringFormat='{}{0:F1} keys/min'}" 
                           Foreground="#FFD7BA7D" FontWeight="Bold" VerticalAlignment="Center"/>
            </StackPanel>
        </Border>
        
        <!-- Keyboard layout -->
        <Viewbox Grid.Row="1" Stretch="Uniform" Margin="10">
            <Canvas x:Name="KeyboardCanvas" Width="1100" Height="350">
                <!-- Keys will be added programmatically -->
            </Canvas>
        </Viewbox>
        
        <!-- Legend -->
        <Border Grid.Row="1" HorizontalAlignment="Right" VerticalAlignment="Bottom" 
                Background="#CC252526" CornerRadius="5" Padding="10" Margin="10">
            <StackPanel>
                <TextBlock Text="Heat Level" Foreground="White" FontWeight="Bold" Margin="0,0,0,5"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="100"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock x:Name="LowLabel" Grid.Column="0" Text="Low" Foreground="#FF0080FF" FontSize="10"/>
                    
                    <Rectangle x:Name="HeatLegendGradient" Grid.Column="1" Height="10" Margin="5,0">
                        <Rectangle.Fill>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#FF0080FF" Offset="0.0"/>
                                <GradientStop Color="#FF00FFFF" Offset="0.2"/>
                                <GradientStop Color="#FF00FF00" Offset="0.4"/>
                                <GradientStop Color="#FFFFFF00" Offset="0.6"/>
                                <GradientStop Color="#FFFF8000" Offset="0.8"/>
                                <GradientStop Color="#FFFF0000" Offset="1.0"/>
                            </LinearGradientBrush>
                        </Rectangle.Fill>
                    </Rectangle>
                    
                    <TextBlock x:Name="HighLabel" Grid.Column="2" Text="High" Foreground="#FFFF0000" FontSize="10"/>
                </Grid>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>